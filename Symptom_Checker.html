<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plexus Care - Symptom Checker</title>
    <link rel="icon" href="data:,"> <!-- Prevents favicon.ico 404 error -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Load Font Awesome only once (using the latest version) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Load custom styles -->

    <link rel="stylesheet" href="css/Symptom_Checker.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo"><i class="fas fa-heartbeat"></i>
                <span>Plexus Care</span>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="Drugs_supl.html">Drugs & Supplements</a></li>
                    <li><a href="Doctor.html">Find a Doctor</a></li>
                    <li><a href="food_recipes.html">Meal Planner</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Print Section -->
        <div class="print-section">
            <button class="print-btn" onclick="togglePrintDropdown()">
                üñ®Ô∏è Print
            </button>
            <div class="print-dropdown" id="printDropdown">
                <div class="print-option" onclick="printConditionDetails()"><i class="fas fa-print"></i> Condition
                    Details</div>
                <div class="print-option" onclick="printTreatmentOptions()"><i class="fas fa-print"></i> Treatment
                    Options</div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('info')">INFO</button>
            <button class="tab-btn" onclick="switchTab('symptoms')">SYMPTOMS</button>
            <button class="tab-btn" onclick="switchTab('conditions')">CONDITIONS</button>
            <button class="tab-btn" onclick="switchTab('details')">DETAILS</button>
            <button class="tab-btn" onclick="switchTab('treatment')">TREATMENT</button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- INFO Tab -->
            <div class="tab-pane active" id="info">
                <div class="info-content">
                    <h1 class="info-title">Plexus Care Symptom Checker</h1>
                    <p class="info-subtitle">Identify possible conditions and treatment related to your symptoms.</p>
                    <div class="info-steps">
                        <div class="info-step">
                            <div class="step-number">1</div>
                            <h3>Select your symptoms</h3>
                            <p>Choose from our list of common symptoms or search for specific ones.</p>
                        </div>
                        <div class="info-step">
                            <div class="step-number">2</div>
                            <h3>Review possible conditions</h3>
                            <p>See a list of conditions that match your symptoms.</p>
                        </div>
                        <div class="info-step">
                            <div class="step-number">3</div>
                            <h3>Get detailed information</h3>
                            <p>Learn about symptoms, treatments, and when to see a doctor.</p>
                        </div>
                    </div>
                    <div class="disclaimer">
                        <strong>This tool does not provide medical advice.</strong>
                        <a href="#" class="disclaimer-toggle" onclick="toggleDisclaimer()">See additional information
                            ‚ñº</a>
                        <div class="disclaimer-content" id="disclaimerContent">
                            This tool does not provide medical advice. This tool is not intended to be a substitute for
                            professional medical advice, diagnosis, or treatment. Always read the label before taking
                            any over-the-counter (OTC) medications. The label identifies the active ingredient(s) and
                            contains other important information including warnings about possible drug interactions and
                            side effects. Always seek the advice of your physician or other qualified health provider
                            with any questions you may have regarding a medical condition. Never disregard professional
                            medical advice or delay in seeking it because of something you have read in this site! If
                            you think you may have a medical emergency, consult your doctor or seek medical attention
                            immediately. We do not recommend or endorse any specific products or services. Reliance on
                            any information provided by Plexus Care is solely at your own risk.
                        </div>
                    </div>

                    <div class="user-inputs">
                        <div class="input-group">
                            <label for="age">Age</label>
                            <input type="number" id="age" value="25" min="1" max="120">
                        </div>
                        <div class="input-group">
                            <label>Sex</label>
                            <div class="sex-buttons">
                                <button class="sex-btn" onclick="selectSex('male')">Male</button>
                                <button class="sex-btn selected" onclick="selectSex('female')">Female</button>
                            </div>
                        </div>
                    </div>

                    <button class="continue-btn" onclick="switchTab('symptoms')">Continue ‚û§</button>
                </div>
            </div>

            <!-- SYMPTOMS Tab -->
            <div class="tab-pane" id="symptoms">
                <div class="symptoms-header">
                    <h2>What are your symptoms?</h2>
                </div>

                <div class="symptoms-status">
                    <span id="symptomCount">No symptoms added</span>
                </div>

                <div class="symptoms-categories">
                    <div class="category-sidebar">
                        <h3 style="margin-bottom: 15px; color: #333;">Browse Symptoms</h3>
                        <ul class="category-list">
                            <li class="category-item active" onclick="selectCategory('general')">General Symptoms</li>
                            <li class="category-item" onclick="selectCategory('skin')">Skin Symptoms</li>
                            <li class="category-item" onclick="selectCategory('head')">Head</li>
                            <li class="category-item" onclick="selectCategory('neck')">Neck</li>
                            <li class="category-item" onclick="selectCategory('chest')">Chest</li>
                            <li class="category-item" onclick="selectCategory('arms')">Arms</li>
                            <li class="category-item" onclick="selectCategory('abdomen')">Abdomen</li>
                            <li class="category-item" onclick="selectCategory('pelvis')">Pelvis</li>
                            <li class="category-item" onclick="selectCategory('back')">Back</li>
                            <li class="category-item" onclick="selectCategory('buttocks')">Buttocks</li>
                            <li class="category-item" onclick="selectCategory('legs')">Legs</li>
                            <li class="category-item" onclick="selectCategory('all')">All Symptoms</li>
                        </ul>
                    </div>

                    <div class="symptoms-content">
                        <div class="symptoms-filter">
                            <span style="font-weight: 600;">Symptoms</span>
                            <button class="filter-btn active" onclick="toggleFilter('all')">All</button>
                            <button class="filter-btn" onclick="toggleFilter('common')">Common</button>
                        </div>

                        <div class="symptoms-grid" id="symptomsGrid">
                            <!-- Symptoms will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="nav-btn" onclick="switchTab('info')">Previous</button>
                    <button class="nav-btn primary" onclick="switchTab('conditions')">Continue</button>
                </div>
            </div>

            <!-- CONDITIONS Tab -->
            <div class="tab-pane" id="conditions">
                <div class="conditions-grid">
                    <div>
                        <div style="margin-bottom: 20px;">
                            <h3>Conditions that match your symptoms</h3>
                            <small style="color: #17a2b8; font-weight: 500;">UNDERSTANDING YOUR RESULTS ‚ìò</small>
                        </div>

                        <!-- Dynamic list populated by JS -->
                        <div class="conditions-list" id="conditionsList">
                            <!-- JS will insert condition cards here -->
                        </div>

                        <button class="start-over-btn" onclick="startOver()">
                            üîÑ Start Over
                        </button>
                    </div>

                    <div class="condition-details" id="conditionDetails">
                        <div class="user-info">
                            <div class="user-info-row">
                                <span><strong>Gender:</strong> Female</span>
                                <span><strong>Age:</strong> 23</span>
                                <a href="#" class="edit-btn" onclick="switchTab('info')">Edit</a>
                            </div>
                            <div class="user-info-row">
                                <span><strong>My Symptoms</strong></span>
                                <a href="#" class="edit-btn" onclick="switchTab('symptoms')">Edit</a>
                            </div>
                            <!-- Will be filled by JS -->
                            <div class="symptoms-list" id="selectedSymptomsList"></div>
                        </div>

                        <div class="condition-selection-prompt">
                            <h3>Select a condition to view details</h3>
                            <p>Click on any condition card to see detailed information and treatment options</p>
                        </div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button class="nav-btn" onclick="switchTab('symptoms')">Previous</button>
                    <button class="nav-btn primary" onclick="switchTab('details')">Continue</button>
                </div>
            </div>

            <!-- DETAILS Tab -->
            <div class="tab-pane" id="details">
                <div class="tab-content-header">
                    <h2 id="detailsTitle">Condition Details</h2>
                    <p id="detailsSubtitle">Detailed information about your condition</p>
                </div>
                <div id="detailsContent" class="tab-content-body">
                    <!-- Content will be loaded by JavaScript -->
                </div>
                <div class="navigation-buttons">
                    <button class="nav-btn" onclick="switchTab('conditions')">Back to Conditions</button>
                    <button class="nav-btn primary" onclick="switchTab('treatment')">View Treatment Options</button>
                </div>
            </div>

            <!-- TREATMENT Tab -->
            <div class="tab-pane" id="treatment">
                <div class="tab-content-header">
                    <h2 id="treatmentTitle">Treatment Options</h2>
                    <p id="treatmentSubtitle">Recommended treatments and next steps</p>
                </div>
                <div id="treatmentContent" class="tab-content-body">
                    <!-- Content will be loaded by JavaScript -->
                </div>
                <div class="navigation-buttons">
                    <button class="nav-btn" onclick="switchTab('details')">Back to Details</button>
                    <button class="nav-btn primary" onclick="startOver()">Start Over</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="#about">About Us</a>
                <a href="#privacy">Privacy Policy</a>
                <a href="#terms">Terms of Service</a>
                <a href="#contact">Contact Support</a>
                <a href="#careers">Careers</a>
            </div>
            <p>&copy; 2025 Plexus Care. All rights reserved.</p>
        </div>
    </footer>

    <!-- LOGIN MODAL -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <h2 id="authTitle">Login</h2>

            <input type="email" id="authEmail" placeholder="Email" required>
            <input type="password" id="authPassword" placeholder="Password" required>

            <button onclick="handleAuth()">Login</button>
            <p id="authSwitch">Don‚Äôt have an account?
                <a href="#" onclick="toggleAuthMode()">Sign up</a>
            </p>
        </div>
    </div>
    <!-- Supabase SDK -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- Config & App Scripts -->
    <script src="./js/config.js"></script>
    <script src="./js/symptom_checker.js"></script>

    <!-- AI Chat Interface -->
    <button class="chat-bot-button" id="chatBotButton" aria-label="Open chat">
        <i class="fas fa-robot"></i>
    </button>

    <div class="chat-container" id="chatContainer">
        <div class="chat-header" id="chatHeader">
            <h3>Plexus Care Assistant</h3>
            <button class="chat-close" id="chatClose" aria-label="Close chat">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be added here dynamically -->
        </div>
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" 
                   placeholder="Describe your symptoms..." 
                   aria-label="Type your message">
            <button class="chat-send" id="chatSend" aria-label="Send message">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/symptom-checker-db.js"></script>
    <script src="js/Symptom_Checker.js"></script>
    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM fully loaded');
            
            // Get chat elements
            const chatBotButton = document.getElementById('chatBotButton');
            const chatContainer = document.getElementById('chatContainer');
            const chatClose = document.getElementById('chatClose');
            const chatMessages = document.getElementById('chatMessages');
            const chatInput = document.getElementById('chatInput');
            const chatSend = document.getElementById('chatSend');
            
            // Log elements to console for debugging
            console.log('Chat elements:', {
                chatBotButton,
                chatContainer,
                chatClose,
                chatMessages,
                chatInput,
                chatSend
            });
            
            // Toggle chat window
            function toggleChat(e) {
                e.stopPropagation(); // Prevent event bubbling
                console.log('Toggle chat called');
                chatContainer.classList.toggle('open');
                if (chatContainer.classList.contains('open')) {
                    chatInput.focus();
                    // Add welcome message if chat is empty
                    if (chatMessages.children.length === 0) {
                        addBotMessage('Hello! I\'m your Plexus Care Assistant. How can I help you today?');
                    }
                }
            }

            // Add a message to the chat
            function addMessage(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isUser ? 'message-user' : 'message-ai'}`;
                messageDiv.textContent = text;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                return messageDiv;
            }

            // Add typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                return typingDiv;
            }

            // Remove typing indicator
            function hideTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            // Add bot message with typing effect
            function addBotMessage(text) {
                const typingIndicator = showTypingIndicator();
                
                // Simulate typing delay
                setTimeout(() => {
                    hideTypingIndicator();
                    const messageDiv = addMessage('', false);
                    
                    // Type the message character by character
                    let i = 0;
                    const typingInterval = setInterval(() => {
                        if (i < text.length) {
                            messageDiv.textContent += text.charAt(i);
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                            i++;
                        } else {
                            clearInterval(typingInterval);
                        }
                    }, 20);
                }, 1000);
            }

            // Generate AI response based on user input
            function generateAIResponse(userInput) {
                const lowerInput = userInput.toLowerCase();
                
                // Check for emergency keywords
                const emergencyKeywords = ['emergency', 'chest pain', 'can\'t breathe', 'severe pain', 'passing out'];
                const isEmergency = emergencyKeywords.some(keyword => lowerInput.includes(keyword));
                
                if (isEmergency) {
                    return {
                        message: "I'm really sorry to hear you're experiencing this. Based on your symptoms, this could be serious. Please seek immediate medical attention or call emergency services right away.",
                        isEmergency: true
                    };
                }
                
                // Check for common symptoms and provide guidance
                const symptomResponses = {
                    'headache': 'Headaches can have many causes, including stress, dehydration, or tension. Try drinking water, resting in a quiet room, and applying a cool compress to your forehead. If the headache is severe or persistent, consult a healthcare professional.',
                    'fever': 'A fever is often a sign that your body is fighting an infection. Make sure to stay hydrated, get plenty of rest, and monitor your temperature. If your fever is above 103¬∞F (39.4¬∞C) or lasts more than 3 days, please see a doctor.',
                    'cough': 'A cough can be caused by various factors like cold, allergies, or irritation. Stay hydrated, use a humidifier, and try honey with warm water. If your cough is severe, lasts more than 3 weeks, or is accompanied by difficulty breathing, seek medical attention.',
                    'stomach pain': 'For mild stomach pain, try drinking clear fluids, eating bland foods, and resting. Avoid dairy, caffeine, and fatty foods. If the pain is severe, persistent, or accompanied by vomiting, fever, or blood, seek medical help immediately.'
                };
                
                // Find matching symptom
                for (const [symptom, response] of Object.entries(symptomResponses)) {
                    if (lowerInput.includes(symptom)) {
                        return {
                            message: response,
                            showSelfCare: true,
                            symptom: symptom
                        };
                    }
                }
                
                // Default response for unrecognized symptoms
                return {
                    message: "I understand you're not feeling well. Could you provide more details about your symptoms? For example, how long you've been experiencing them and their severity would be helpful for better assistance.",
                    needsMoreInfo: true
                };
            }

            // Handle user sending a message
            function handleUserMessage() {
                const message = chatInput.value.trim();
                if (message === '') return;
                
                // Add user message to chat
                addMessage(message, true);
                chatInput.value = '';
                
                // Generate and add AI response
                const response = generateAIResponse(message);
                
                if (response.isEmergency) {
                    addBotMessage(response.message);
                    addBotMessage("üö® **This is important:** Please call emergency services or go to the nearest emergency room immediately if you haven't already.");
                    return;
                }
                
                addBotMessage(response.message);
                
                // Add self-care recommendations if applicable
                if (response.showSelfCare) {
                    setTimeout(() => {
                        const selfCareDiv = document.createElement('div');
                        selfCareDiv.className = 'self-care-card';
                        selfCareDiv.innerHTML = `
                            <h4>Self-Care Recommendations</h4>
                            <ul>
                                <li>Get plenty of rest</li>
                                <li>Stay hydrated by drinking water</li>
                                <li>Use over-the-counter pain relievers if needed</li>
                                <li>Apply a warm or cold compress as appropriate</li>
                                <li>Monitor your symptoms for any changes</li>
                            </ul>
                        `;
                        chatMessages.appendChild(selfCareDiv);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 500);
                }
                
                // Add professional help notice if needed
                if (Math.random() > 0.7 || response.isEmergency) {
                    setTimeout(() => {
                        const helpDiv = document.createElement('div');
                        helpDiv.className = 'professional-help';
                        helpDiv.innerHTML = `
                            <h4>When to See a Doctor</h4>
                            <p>Consider seeking professional medical advice if:</p>
                            <ul>
                                <li>Symptoms persist for more than a few days</li>
                                <li>Your symptoms are severe or getting worse</li>
                                <li>You have difficulty breathing or chest pain</li>
                                <li>You develop a high fever</li>
                                <li>You experience confusion or dizziness</li>
                            </ul>
                        `;
                        chatMessages.appendChild(helpDiv);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 1000);
                }
            }

            // Initialize event listeners
            function initChat() {
                console.log('Initializing chat...');
                
                // Add event listeners
                if (chatBotButton) chatBotButton.addEventListener('click', toggleChat);
                if (chatClose) chatClose.addEventListener('click', toggleChat);
                if (chatSend) chatSend.addEventListener('click', handleUserMessage);
                
                // Send message on Enter key
                if (chatInput) {
                    chatInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            handleUserMessage();
                        }
                    });
                }
                
                // Close chat when clicking outside
                document.addEventListener('click', function(e) {
                    if (chatContainer && !chatContainer.contains(e.target) && e.target !== chatBotButton) {
                        chatContainer.classList.remove('open');
                    }
                });
                
                console.log('Chat initialized');
            }
            
            // Initialize the chat
            initChat();
        });
    </script>
    </script>
</body>

</html>